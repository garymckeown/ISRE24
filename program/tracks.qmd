---
title: "`r paste(params$PSSlot,': ',params$Track)`"
execute: 
  echo: false
  
format: 
  html:
    page-layout: full
  
params:
  PSSlot: "Parallel Session 1"
  Track: "T1"
---

```{r}
#| include: false

# libraries --------------------------------------------------------------------
library(googlesheets4)
library(tidyverse)
library(DT)
# data -------------------------------------------------------------------------
isre24_program_communications <-
  read_sheet("https://docs.google.com/spreadsheets/d/1IXNmqqwtPi70zxuf4q6QTpIsFi4anOuSm4RZySt_m7A")

isre24_track <- isre24_program_communications |>
  filter(PSSlot == params$PSSlot) |>
  filter(Track == params$Track)
```

```{r}
track_details <- isre24_track |> 
  mutate(Time = paste(format(min(StartTime), format = "%H:%M"), "-", format(max(EndTime), format = "%H:%M"))) |> 
  select(Track, TYPE, SessionTitle, Time, Room) |> 
  distinct() |> 
  t() |> 
  as.data.frame() |> 
  rownames_to_column()
  
track_details |> 
  datatable(
    colnames = NULL,
    rownames = FALSE,
    options = list(
      dom = 't', 
      pageLength = -1, 
      ordering = FALSE
      )
    ) |> 
  formatStyle(colnames(track_details), fontSize = '125%') |> 
  formatStyle("rowname", color = 'white', backgroundColor = 'red', fontWeight = 'bold')
```

```{r}
isre24_track |> 
  select(Title = Paper.Title, Time, Authors, Abstract) |> 
  pivot_longer(!Title) |> 
  datatable(
    colnames = NULL,
    rownames = FALSE,
    extensions = 'RowGroup',
    options = list(
      dom = 't', 
      pageLength = -1, 
      ordering = FALSE,
      rowGroup = list(dataSrc = 0),
      columnDefs = list(list(visible = FALSE, targets = 0))
  )
)
```

